<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title th:text="${pageTitle}">Sản phẩm của tôi</title>
    <link rel="stylesheet" th:href="@{/vendor/bootstrap/bootstrap.min.css}" />
    <link rel="stylesheet" th:href="@{/fonts/fontawesome/fontawesome.min.css}" />
    <link rel="stylesheet" th:href="@{/css/main.css}" />
    <link rel="stylesheet" th:href="@{/css/vendor.css}" />
  </head>
  <body>
    <header th:replace="~{/web/fragments/header :: header}"></header>

    <main class="section" style="padding-top: 40px;">
      <div class="container">
        <div th:replace="~{vendor/fragments/nav :: vendorNav('products')}"></div>

        <div th:if="${success != null}" class="alert alert-success">[[${success}]]</div>
        <div th:if="${error != null}" class="alert alert-danger">[[${error}]]</div>
        <div th:if="${warning != null}" class="alert alert-warning">[[${warning}]]</div>

        <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-3">
          <div>
            <h2 class="mb-1">Sản phẩm của tôi</h2>
            <p class="text-muted mb-0" th:text="${shop.shopName}">Tên shop</p>
          </div>
          <a class="btn btn-primary" th:href="@{/vendor/products/new}">
            <i class="fas fa-plus"></i> Thêm sản phẩm
          </a>
        </div>

        <div th:if="${products == null || #lists.isEmpty(products)}" class="vendor-empty">
          <i class="fas fa-box-open"></i>
          <p>Chưa có sản phẩm nào. Hãy thêm sản phẩm đầu tiên của bạn!</p>
          <a class="btn btn-primary" th:href="@{/vendor/products/new}">Thêm sản phẩm ngay</a>
        </div>

        <div th:if="${products != null && !#lists.isEmpty(products)}" class="table-responsive vendor-card">
          <table class="table align-middle vendor-table">
            <thead>
              <tr>
                <th>Hình ảnh</th>
                <th>Tên sản phẩm</th>
                <th>Danh mục</th>
                <th>Giá</th>
                <th>Giảm giá</th>
                <th>Số lượng</th>
                <th>Trạng thái</th>
                <th class="text-end">Thao tác</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="item : ${products}">
                <td>
                  <img th:if="${item.productImage != null}" th:src="@{'/loadImage?imageName=' + ${item.productImage}}" alt="Ảnh sản phẩm" />
                  <div th:if="${item.productImage == null}" class="text-muted">--</div>
                </td>
                <td>
                  <strong th:text="${item.productName}">Tên sản phẩm</strong>
                  <div class="text-muted small" th:text="${#strings.abbreviate(item.description, 80)}"></div>
                </td>
                <td th:text="${item.category != null ? item.category.categoryName : '---'}">Danh mục</td>
                <td th:text="${#numbers.formatDecimal(item.price,1,'DEFAULT',0,'DEFAULT')} + ' đ'">0 đ</td>
                <td th:text="${item.discount} + '%'">0%</td>
                <td th:text="${item.quantity}">0</td>
                <td>
                  <span class="badge" th:classappend="${item.status} ? ' bg-success' : ' bg-secondary'"
                        th:text="${item.status} ? 'Đang bán' : 'Ngừng bán'">Trạng thái</span>
                </td>
                <td class="text-end vendor-actions">
                  <a class="btn btn-sm btn-outline-primary" th:href="@{'/vendor/products/' + ${item.productId} + '/edit'}">
                    <i class="fas fa-edit"></i>
                  </a>
                  <form th:action="@{'/vendor/products/' + ${item.productId} + '/delete'}" method="post" class="d-inline" onsubmit="return confirm('Bạn chắc chắn muốn xóa sản phẩm này?');">
                    <button class="btn btn-sm btn-outline-danger" type="submit">
                      <i class="fas fa-trash"></i>
                    </button>
                  </form>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </main>

    <footer th:replace="~{/web/fragments/footer :: footer}"></footer>

    <script th:src="@{/vendor/bootstrap/jquery-3.6.0.min.js}"></script>
    <script th:src="@{/vendor/bootstrap/bootstrap.bundle.min.js}"></script>
  </body>
</html>

